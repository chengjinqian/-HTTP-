1.用TCP套接字编程

![](http://or155uq3h.bkt.clouddn.com/TCP%E5%A5%97%E6%8E%A5%E5%AD%97.png)
首先在服务器端：

- S1：创建新的套接字（socket）
- S2: 将套接字绑定到端口80上去（bind）
- S3: 允许套接字进行连接（listen）
- S4: 等待连接（accept）

然后在客户端

- C1:获取IP地址和端口号
- C2:创建新的套接字（socket）
- C3:连接到服务器IP：port上去（connect)

然后在服务器端
- S5:通知应用程序有连接到来
- S6:开始读取请求（read）

然后在客户端：
- C4:连接成功
- C5:发送HTTP请求（write）
- C6:等待HTTP响应（read）

然后在服务端
- S7：处理HTTP请求
- S8:回送HTTP响应（write）
- S9：关闭连接

客户端
- C7:处理HTTP响应
- C8:关闭连接（close）


2.TCP的慢启动

TCP数据传输性能取决于TCP连接的使用期，TCP连接会随着时间进行自我调谐，起初会限制连接的最大速度，如果数据成功传输，会随着时间的推移提高传输的速度。

TCP慢启动限制了一个TCP端点在任意时刻可以传输的分组数，简单来说，每成功接受一个分组，发送端就有了发送两个分组的权限。当HTTP有大量数据传输时，必须发送一个分组，等待确认后可以发送两个分组，每个分组确认后就可以发送四个分组，以此类推，被称为“打开拥塞窗口”。

3.Nagle算法

TCP有一个数据流接口，应用程序可以通过它将任意尺寸的数据放入TCP栈中，但是每个TCP至少装载了40个字节的标记和首部，如果TCP有大量包含少量的数据分组，则会使网络性能严重下降。

因此，Nagle会试图在发送一个分组之前，将大量TCP数据绑定在一起，以提高网络效率，其鼓励发送全尺寸的段，如果其他分组仍在传输中，就把那部分数据缓存起来，只有当挂起分组被确认或者缓存中积累了足够发送一个全尺寸分组的数据时，才会将缓存的数据发送出去。
